#pragma version 8

// test_cases.arc4_types.string.Arc4StringTypesContract.approval_program() -> uint64:
main_block@0:
        byte "Hello World!"
        dup
        swap
        dup
        len
        itob
        extract 6 2
        dig 1
        concat
        dup
        cover 2
        dup
        extract 2 0
        cover 2
        dup
        cover 2
        !=
        assert // Original bytes should not match encoded bytes
        len
        dup
        swap
        int 2
        >
        bz main_ternary_false@2

main_ternary_true@1:
        int 2
        b main_ternary_merge@3

main_ternary_false@2:
        dup

main_ternary_merge@3:
        dig 3
        dup
        len
        swap
        uncover 2
        uncover 2
        substring3
        dig 4
        dup
        cover 2
        ==
        assert // Original bytes should match encoded if we strip the length header
        dig 2
        ==
        assert
        byte "\x00\x05Hello"
        byte "\x00\x01 "
        byte "\x00\x06World!"
        cover 2
        dup
        int 0
        extract_uint16
        swap
        extract 2 0
        uncover 2
        swap
        uncover 2
        callsub dynamic_array_concat_fixed_size
        dig 1
        int 0
        extract_uint16
        swap
        uncover 2
        extract 2 0
        uncover 2
        callsub dynamic_array_concat_fixed_size
        byte "\x00\x0cHello World!"
        ==
        assert
        byte "\x00\x02hi"
        dup
        int 0
        extract_uint16
        swap
        dup
        extract 2 0
        uncover 2
        callsub dynamic_array_concat_fixed_size
        byte "\x00\x04hihi"
        ==
        assert
        byte "\x00\x01b"
        int 0
        extract_uint16
        byte "\x00\x01b"
        extract 2 0
        byte "\x00\x01a"
        swap
        uncover 2
        callsub dynamic_array_concat_fixed_size
        byte "\x00\x01c"
        int 0
        extract_uint16
        byte "\x00\x01c"
        extract 2 0
        uncover 2
        swap
        uncover 2
        callsub dynamic_array_concat_fixed_size
        byte "\x00\x01d"
        int 0
        extract_uint16
        byte "\x00\x01d"
        extract 2 0
        uncover 2
        swap
        uncover 2
        callsub dynamic_array_concat_fixed_size
        byte "\x00\x01e"
        int 0
        extract_uint16
        byte "\x00\x01e"
        extract 2 0
        uncover 2
        swap
        uncover 2
        callsub dynamic_array_concat_fixed_size
        byte "\x00\x01f"
        int 0
        extract_uint16
        byte "\x00\x01f"
        extract 2 0
        uncover 2
        swap
        uncover 2
        callsub dynamic_array_concat_fixed_size
        byte "\x00\x01g"
        int 0
        extract_uint16
        byte "\x00\x01g"
        extract 2 0
        uncover 2
        swap
        uncover 2
        callsub dynamic_array_concat_fixed_size
        byte "\x00\x07abcdefg"
        ==
        assert
        int 1
        return


// puyapy_lib_arc4.dynamic_array_concat_fixed_size(source#0: bytes, new_items_bytes#0: bytes, new_items_count#0: uint64) -> bytes:
dynamic_array_concat_fixed_size:
        proto 3 1

dynamic_array_concat_fixed_size_block@0:
        frame_dig -3
        int 0
        extract_uint16
        frame_dig -1
        +
        itob
        int 6
        int 8
        substring3
        frame_dig -3
        int 0
        uncover 2
        replace3
        dup
        frame_bury -3
        frame_dig -2
        concat
        dup
        frame_bury -3
        retsub

